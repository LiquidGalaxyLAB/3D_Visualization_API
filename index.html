<!DOCTYPE html>
<html>
   <head>
      <title>Graphical Liquid Galaxy API</title>
   </head>
   
   <script src = "/socket.io/socket.io.js"></script>
   <script src="https://threejs.org/build/three.js"></script>
   <script>
      var socket = io();
      var id;
      var active;
      socket.on('idSet', function(data) {
         id = data.id;
         active = data.active;
         console.log()
      });

      socket.on('nextScreen', function(data) {
         active = data == id;
      });
      socket.on('oneLessScreen', function(data) {
         if(id > data.noUser) id--;
         active = data.active == id;
      });
   </script>
   
   <body>
      <div id = "error-container"></div>
      <script>
          const width  = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
          const height = window.innerHeight|| document.documentElement.clientHeight||  document.body.clientHeight;

          console.log(width)
         var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );

        var renderer = new THREE.WebGLRenderer();
        renderer.setSize( window.innerWidth, window.innerHeight );
        document.body.appendChild( renderer.domElement );

        var geometry = new THREE.BoxGeometry();
        var material = new THREE.MeshBasicMaterial( { color: 0x00ff00 } );
        var cube = new THREE.Mesh( geometry, material );
        scene.add( cube );

        camera.position.z = 5;
        var position
        var copyCamera= camera.clone();
        position = cube.position.clone();
        position.project(camera);
        window.addEventListener( 'resize', onWindowResize, false );
       
        var animate = function () {
            requestAnimationFrame( animate );

            if(active){
                cube.position.x += 0.05;
                position = cube.position.clone();
                position.project(camera);
                if(position.x>1){
                    cube.position.x = -5;
                    socket.emit('moveObject', id);
                }
            }else{
                cube.position.x = -5;
            }
            
           
            renderer.render( scene, camera );
        };

        animate();

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize( window.innerWidth, window.innerHeight );
        }
      </script>
   </body>
</html>